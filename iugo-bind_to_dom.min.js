/* Author Chris Scott, MIT license */
$iugo.store.BD={a:[],b:{}};$iugo.initializers.push(function(a){for(var l=0,h=/(>[^<$]*)\$\{([^:.}<]+:)?([^}<]*)\}([^<]*<)/g;a.innerHTML.match(h);)a.innerHTML=a.innerHTML.replace(h,function(j,e,a,f,b){j=e+"<span ";a&&(j+='class="bindto-'+a.substr(0,a.length-1)+'" ');return j+('data-bind_key="'+f+'"></span>'+b)});a.innerHTML=a.innerHTML.replace(/<[^>]+ [^ =]+="[^"]*\$\{[^}<"]+\}[^"]*"[^>]*>/g,function(a){var e=l++;$iugo.store.BD.a[e]={d:[],c:{},e:{}};a=a.replace(/([^ =]+)="([^"]*\$\{[^}"]+\}[^"]*)"/g,function(a,f,b){"data-iugo_alias-"==f.substr(0,16)&&(f=f.substr(16));$iugo.store.BD.a[e].d.push(f);$iugo.store.BD.a[e].c[f]=b;b.replace(/\$\{([^"}:]+):[^}"]+\}/g,function(a,b){$iugo.store.BD.b[b]||($iugo.store.BD.b[b]=[]);-1==$iugo.store.BD.b[b].indexOf(e)&&$iugo.store.BD.b[b].push(e)});return f+'=""'});return a=a.replace(/ ?>$/,' data-iugo_id="'+e+'">')})});$iugo.defaultViewcontrollers.push(function(a,l,h){function j(a,c,b){if(c.hasAttribute("data-iugo_id")){var d=c.getAttribute("data-iugo_id");c=$iugo.store.BD.a[d].d;for(var g=0;g<c.length;g++)$iugo.store.BD.a[d].c[c[g]].replace(n,function(c,e,g){if(!e&&!b||e&&e.substr(0,e.length-1)==b){e=g.split(".");g=a;for(var f=0;f<e.length;f++)g=g[e[f]];$iugo.store.BD.a[d].e[c]=g}});c=document.querySelector('[data-iugo_id="'+d+'"]');for(var g=$iugo.store.BD.a[d].d,e=0;e<g.length;e++){var f=$iugo.store.BD.a[d].c[g[e]].replace(n,function(c){return $iugo.store.BD.a[d].e[c]?$iugo.store.BD.a[d].e[c]:""});c.setAttribute(g[e],f)}}}function e(a,c,b){j(a,c);if(a instanceof Array){b=c.children.length;for(var d=b-1;0<=d;d--)c.children[d].classList.contains("iugo_cloned")&&c.removeChild(c.children[d]);b=c.children.length;for(d=0;d<b;d++){var g;if(c.children[d].hasAttribute("data-bind_each")){g=c.children[d];0==a.length?(g.setAttribute("data-iugo_display",g.style.display),g.style.display="none"):g.style.display=g.getAttribute("data-iugo_display");for(var f=0;f<a.length;f++){var h;1<=f?(h=g.cloneNode(!0),h.classList.add("iugo_cloned"),c.appendChild(h)):h=g;e(a[f],h)}}}}else if(a instanceof Object){d=c.getAttribute("data-bind_key");null!=d&&""!=d&&(b=null==b?"":b+".",d=d.slice(b.length).split(".")[0],e(a[d],c,b+d));for(d=0;d<c.children.length;d++)c.children[d].className.match("bindto-")||e(a,c.children[d],b)}else"INPUT"==c.tagName?c.value=a:c.innerHTML=a}var n=/\$\{([^:}]+:)?([^}]+)\}/g;if($iugo.store.BD.b[a])for(var f=$iugo.store.BD.b[a],b=0;b<f.length;b++)for(var k=h.querySelectorAll('[data-iugo_id="'+f[b]+'"]'),m=0;m<k.length;m++)j(l,k[m],a);k=h.getElementsByClassName("bindto-"+a);for(b=0;b<k.length;b++)e(l,k[b])});